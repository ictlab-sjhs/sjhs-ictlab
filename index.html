<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICT Laboratory</title>
    <link rel="stylesheet" href="style.css">
    <style>
        iframe {
            border: none;
            width: 100%;
            height: 500px;
            margin-top: 10px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 15px;
            background: white;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
        }
        th {
            background: #f4f4f4;
        }
    </style>
</head>
<body>
<header>
    <img src="logo.png" alt="School Logo" style="height:80px;">
    <h1 style="font-size:2.5rem;">ICT Laboratory</h1>
</header>

<section class="hero">
  <div class="hero__overlay">
    <h1>Step Into the Future at San Juan HS ICT Lab 🚀</h1>
    <p class="hero__subtitle">
      Your gateway to learning, creating, and connecting with the world.
    </p>

    <ul class="hero__features">
      <li>💻 <strong>High-speed internet access</strong></li>
      <li>🖥 <strong>Modern, fully-equipped computer systems</strong></li>
      <li>📡 <strong>Seamless global connectivity</strong></li>
    </ul>

    <p class="hero__location">
      Visit <strong>Room 4, 2nd Floor, Senior High School Building</strong> during your free time.
    </p>

    <a class="hero__btn" href="#reservation">Make a Reservation</a>
  </div>
</section>

<nav>
    <a href="index.html">Home</a>
    <a href="rules.html">Lab Rules</a>
    <a href="schedule.html">Schedule</a>
    <a href="resources.html">Resources</a>
    <a href="contact.html">Contact</a>
</nav>

<main>
    <div class="card">
        <h2>Welcome to the ICT Laboratory</h2>
        <p>This site provides information about our lab rules, schedules, and learning resources.</p>
    </div>

    <div class="card" id="reservation">
        <h2>Latest Announcements</h2>
        <ul>
            <li>📢 <strong>Maintenance Day</strong> – Every last Friday of the month.</li>
            <li>🖥️ <strong>New software</strong> installed: Visual Studio Code</li>
            <li>📅 <strong>Check live schedule below before making reservations.</strong></li>
        </ul>
        
        <p>
            <a href="https://forms.gle/hjAeXV3Skh86CzfY9">
                📌 Reserve a Time Slot
            </a>
        </p>

        <!-- Google Calendar Embed -->
        <iframe src="https://calendar.google.com/calendar/embed?src=51b5e71b3bb2649cc677b90dd2913fd959a13e44c7682f3549a203c9d0f5b097%40group.calendar.google.com&ctz=Asia%2FManila" style="border: 0" width="800" height="600" frameborder="0" scrolling="no"></iframe>

        <!-- Live Reservation Table -->
        <h3>📋 Latest Reservations</h3>
        <table id="reservationTable">
            <thead></thead>
            <tbody></tbody>
        </table>
    </div>
</main>

<footer>
    &copy; 2025 ICT Laboratory | San Juan High School
</footer>

<!-- Fetch and display Google Sheet CSV -->
<script>
fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vSSiQASdtS4yb0zQjAUkoI5q5sKbGYRvyEBWRYbWJ1xcVgBRGshK92_xYxAwha4XnaGkQQwMxUnyJSt/pub?gid=1376688583&single=true&output=csv")
  .then(response => response.text())
  .then(csv => {
    const rows = csv.split("\n").map(row => row.split(","));
    const thead = document.querySelector("#reservationTable thead");
    const tbody = document.querySelector("#reservationTable tbody");

    // Header row
    const headerRow = document.createElement("tr");
    rows[0].forEach(cell => {
      const th = document.createElement("th");
      th.textContent = cell;
      headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);

    // Data rows
    rows.slice(1).forEach(row => {
      if (row.length > 1) { // Skip empty rows
        const tr = document.createElement("tr");
        row.forEach(cell => {
          const td = document.createElement("td");
          td.textContent = cell;
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      }
    });
  })
  .catch(error => console.error("Error loading CSV:", error));
</script>

</body>
</html>
